{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","src/javascripts/library/library.js","src/javascripts/library/api-library.js","node_modules/@parcel/runtime-js/lib/runtime-0e91dd5fd4a73031.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","src/fetch/api_key.js","node_modules/@parcel/runtime-js/lib/runtime-bea7d329698d5d7d.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","import API from './api-library';\nimport defaultImg from '../../images/default.jpg';\nimport { STORAGE_KEY } from '../../fetch/api_key';\n// import { openModalAboutFilm } from '../movieModal';\n\nconst libraryRef = document.querySelector('.library-card-list');\nconst btnLib = document.querySelector('.btn');\nconsole.log(document.querySelector('.btn'));\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  const library = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];\n  // if(libraryRef) createLibraryMarkup(library);\n  let totalElementInList = 0;\n  let firstEl = 0;\n  getLibrarylistInParts(library);\n});\n\nbtnLib?.addEventListener('click', function (event) {\n  console.log('AAAAAAA');\n  getLibrarylistInParts(library);\n  firstEl += 6;\n  totalElementInList += 6;\n});\nconsole.log(btnLib);\n\nlet totalElementInList = 0;\nlet firstEl = 0;\nfunction getLibrarylistInParts(library) {\n  const totalLiberyLength = library.length;\n  console.log(totalLiberyLength);\n\n  lostEl = firstEl + 6;\n  console.log(firstEl);\n  console.log(lostEl);\n  console.log(totalLiberyLength);\n  console.log(totalLiberyLength - totalElementInList);\n\n  const libraryInParts = library.slice(firstEl, lostEl);\n  console.log(libraryInParts);\n  if (totalLiberyLength - totalElementInList <= 6) {\n    createLibraryMarkup(libraryInParts);\n  } else {\n    createLibraryMarkup(libraryInParts);\n    libraryRef.insertAdjacentHTML(\n      'afterend',\n      ` <div class=\"lib-btn-cont\"><button class=\"btn btn-search-movie\" type=\"button\">Load more</button></div>`\n    );\n  }\n}\n\nexport function handleFilm(e) {\n  const id = e.target.dataset.id;\n  // console.log('btnLib', btnLib);\n  console.log(e.target);\n\n  if (e.target.hasAttribute('data-add')) {\n    console.log('data-add');\n\n    // btnLib.removeAttribute('data-add');\n    // btnLib.setAttribute('data-remove', '');\n    // btnLib.textContent = 'Remove from my library';\n    setBtnProp(e.target, addOps);\n\n    addFilmToLibrary(id);\n\n    //\n  } else if (e.target.hasAttribute('data-remove')) {\n    console.log('data-remove');\n\n    e.target.removeAttribute('data-remove');\n    e.target.setAttribute('data-add', '');\n    e.target.textContent = 'Add to my library';\n\n    deleteCardLibrary(id);\n  }\n}\n\nconst addOps = {\n  addAttr: 'data-remove',\n  removeAttr: 'data-add',\n  btnText: 'Remove from my library',\n};\n\nfunction setBtnProp(el, props) {\n  const { addAttr, removeAttr, btnText } = props;\n\n  el.removeAttribute(removeAttr);\n  el.setAttribute(addAttr, '');\n  el.textContent = btnText;\n}\n\n/////// ПРОВЕРКА НАЛИЧИЯ ID В LOCAL STORAGE /////////\n\n/////// ПОЛУЧЕНИЯ ОТ СЕРВЕРА ФИЛЬМА ПО ID ///////\n\nasync function getMovieById(id) {\n  const responce = await API.getMoviById(id);\n  return responce.data;\n}\n\n///// ФУНКЦИЯ ДОБАВЛЕНИЯ В LOCAL STORAGE ///////\n\nexport async function addFilmToLibrary(id) {\n  const libraryList = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];\n  const isAtLibrary = libraryList?.find(x => x.id === Number(id));\n\n  if (isAtLibrary) return console.log('film is at list');\n\n  const movieObj = await getMovieById(id);\n  libraryList.push(movieObj);\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(libraryList));\n}\n\n///// ФНКЦИЯ УДАЛЕНИЯ ИЗ LOCAL STORAGE ///////\n\nexport function deleteCardLibrary(id) {\n  const libraryList = JSON.parse(localStorage.getItem(STORAGE_KEY));\n  const itemToDelete = libraryList.find(film => film.id === id);\n\n  libraryList.pop(itemToDelete);\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(libraryList));\n\n  if (location.pathname === '/library.html') {\n    // libraryRef.innerHTML = '';\n    createLibraryMarkup(libraryList);\n  }\n}\n\nfunction createLibraryMarkup(libraryInParts) {\n  // console.log(library);\n  if (libraryInParts.length === 0) {\n    libraryRef.innerHTML = `<div class=\"library-info library-info-container\">\n                              <p class=\"library-info-text\">\n                                OOPS... <br> We are very sorry!<br>\n                                You don’t have any movies at your library.\n                              </p>\n                              <button class=\"btn btn-search-movie\" type=\"button\">Search movie</button>\n                            </div>`;\n  } else {\n    const markup = libraryInParts\n      .map(movie => {\n        const imageSrc = movie.poster_path\n          ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`\n          : `${defaultImg}`;\n\n        return `<li class=\"card-item item\">\n              <img class=\"film-poster\" src=\"${imageSrc}\" alt=\"${\n          movie.original_title\n        }\" />\n              <div class=\"overlay\">\n                <div class=\"film-info\">\n                  <p class=\"film-title\">${\n                    movie.original_title || movie.name\n                  }</p>\n                  <div class=\"film-details\">\n                    <span class=\"film-description\">${\n                      new Date(movie.release_date).getFullYear() ||\n                      new Date(movie.first_air_date).getFullYear()\n                    } </span>\n                    <span class=\"film-rating\">${Math.round(\n                      movie.vote_average\n                    )}</span>\n                  </div>\n                </div>\n              </div>\n            </li>`;\n      })\n      .join('');\n\n    libraryRef.innerHTML = markup;\n  }\n}\n\n// const filmList = document.querySelector('.lib-btn-cont');\n// filmList.addEventListener('click', event => {\n//   const li = event.target.closest('.btn');\n//   // const movieId = li.getAttribute('data-id');\n//   // openModalAboutFilm(movieId);\n// });\n","import axios from \"axios\";\n\n\nconst API_KEY = 'b67c8518c930f00572f5eefdd7a9d563';\n\n\nasync function getMoviById(id) {\n    const options = {\n        method: 'GET',\n        headers: {\n          accept: 'application/json',\n          Authorization: `Bearer ${API_KEY}`,\n        },\n      };\n    return axios\n      .get(`https://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}`)\n\n      \n      .then(res => (res))\n      \n      .catch(error => {\n        console.log('EROR');\n      });\n\n     \n}\nexport default { getMoviById }","module.exports = require('./helpers/bundle-url').getBundleURL('gqlnG') + require('./helpers/bundle-manifest').resolve(\"iNwWb\");","\"use strict\";\n\nvar bundleURL = {};\n\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n\n  return value;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|(chrome|moz)-extension):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|(chrome|moz)-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp|(chrome|moz)-extension):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","export const API_KEY =\n  'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI0MWI4Zjk0MzdiZjNmODk5MjgxZjhhM2Y5YmRjMDg5MSIsInN1YiI6IjY0NTY1YjAzOTAzYzUyMDEzODI3ZWIzZCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.qXNl8SarYs-VSAA55-e1i77zVpr6mbLTqlJUsXp4rpE';\n\nexport const API_BAERER =\n  'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJmODU0Y2RkODdhYTkwNTNjYTAwMjI5ZmVhNzNlNTkyNSIsInN1YiI6IjYxODZmYWFkZmU2MzE4MDA2NDgzZTdkZSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.vm-UaTyMPJ2HhXiSRvz-VpPqqqKEF-3PBdhfYlg5v3g';\n\nexport const STORAGE_KEY = 'library';\n","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"gqlnG\\\":\\\"library.d4416224.js\\\",\\\"iNwWb\\\":\\\"default.183d728c.jpg\\\"}\"));"],"names":["$0380ce8f1f064ccc$export$6503ec6e8aabbaf","$0380ce8f1f064ccc$export$f7ad0328861e2f03","$0380ce8f1f064ccc$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","$bpxeT","parcelRequire","$68a7738cfcfa786b$var$libraryRef","document","querySelector","$68a7738cfcfa786b$var$btnLib","console","log","window","addEventListener","$68a7738cfcfa786b$var$getLibrarylistInParts","JSON","parse","localStorage","getItem","$fpBey","STORAGE_KEY","event","library","$68a7738cfcfa786b$var$firstEl","$68a7738cfcfa786b$var$totalElementInList","totalLiberyLength","lostEl","libraryInParts","slice","$68a7738cfcfa786b$var$createLibraryMarkup","insertAdjacentHTML","$68a7738cfcfa786b$export$e5d3b404f42d8e9c","e","el","props","addAttr","removeAttr","btnText","target","dataset","hasAttribute","$68a7738cfcfa786b$var$addOps","removeAttribute","setAttribute","textContent","$68a7738cfcfa786b$var$_addFilmToLibrary","apply","this","arguments","$68a7738cfcfa786b$export$dd91614c16e8fbd7","libraryList","itemToDelete","find","film","pop","setItem","stringify","location","pathname","$68a7738cfcfa786b$export$cbc3412bdf3eebaf","$68a7738cfcfa786b$var$getMovieById","$68a7738cfcfa786b$var$_getMovieById","$parcel$interopDefault","$2TvXO","mark","_callee","responce","$JYr1o","default","getMoviById","_ctx","sent","data","movieObj","x","Number","push","innerHTML","markup","map","movie","imageSrc","poster_path","concat","$Tn86Q","original_title","name","Date","release_date","getFullYear","first_air_date","Math","round","vote_average","join","$08a3152e97b8ae70$var$API_KEY","$08a3152e97b8ae70$var$_getMoviById","method","headers","accept","Authorization","$dIxxU","get","then","res","catch","error","$08a3152e97b8ae70$export$2e2bcd8739ae039","module","exports","getBundleURL","resolve","$7dd1ddf6834435ca$export$bdfd709ae4826697","$7dd1ddf6834435ca$var$bundleURL","$7dd1ddf6834435ca$var$getBaseURL","url","replace","value","err","matches","stack","match","$7dd1ddf6834435ca$var$getBundleURL","$b38612aacf66a568$export$a9861bd62f48e142","$b38612aacf66a568$export$ddba0dca68ef8c8d","$b38612aacf66a568$export$86880b4b2e1a2384","register"],"version":3,"file":"library.d4416224.js.map"}